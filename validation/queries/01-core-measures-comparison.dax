// ============================================================================
// QUERY DE VALIDAÇÃO CRUZADA - MEDIDAS CORE
// ============================================================================
// Objetivo: Comparar resultados das medidas principais entre modelos V2, V3 e Golden Dataset
// Data: 2026-02-03
// Fase: 3 - Validação de Medidas
// ============================================================================

// INSTRUÇÕES DE USO:
// 1. Execute esta query no modelo V2 primeiro e salve os resultados
// 2. Execute no modelo V3 e compare
// 3. Execute no Golden Dataset após migração e valide consistência
// 4. Diferenças aceitáveis: < 0.01% (arredondamento)
// 5. Diferenças > 1% requerem investigação imediata

// ============================================================================
// MEDIDAS DE ESTOQUE - Grupo 1
// ============================================================================

EVALUATE
SUMMARIZECOLUMNS(
    'Dim Calendário'[Ano],
    'Dim Calendário'[Mês],
    "QTD_Estoque_Bruto", [QTD Estoque Bruto],
    "VLR_Estoque_Total", [VLR Estoque Total],
    "QTD_Estoque_Disponivel", [QTD Estoque Disponível],
    "VLR_Estoque_Disponivel", [VLR Estoque Disponível]
)
ORDER BY 'Dim Calendário'[Ano], 'Dim Calendário'[Mês]

// ============================================================================
// MEDIDAS DE VENDAS - Grupo 2
// ============================================================================

// EVALUATE
// SUMMARIZECOLUMNS(
//     'Dim Calendário'[Ano],
//     'Dim Calendário'[Mês],
//     "VLR_Vendas_Total", [VLR Vendas Total],
//     "QTD_Vendas_Total", [QTD Vendas Total],
//     "VLR_Vendas_365d", [VLR Vendas 365d],
//     "QTD_Vendas_365d", [QTD Vendas 365d]
// )
// ORDER BY 'Dim Calendário'[Ano], 'Dim Calendário'[Mês]

// ============================================================================
// MEDIDAS DE COMPRAS - Grupo 3
// ============================================================================

// EVALUATE
// SUMMARIZECOLUMNS(
//     'Dim Calendário'[Ano],
//     'Dim Calendário'[Mês],
//     "VLR_Pedidos_Compras", [VLR Pedidos de Compras],
//     "QTD_Pedidos_Compras", [QTD Pedidos de Compras],
//     "VLR_Entradas", [VLR Entradas],
//     "QTD_Entradas", [QTD Entradas]
// )
// ORDER BY 'Dim Calendário'[Ano], 'Dim Calendário'[Mês]

// ============================================================================
// MEDIDAS CALCULADAS COMPLEXAS - Grupo 4
// ============================================================================

// EVALUATE
// SUMMARIZECOLUMNS(
//     'Dim Produto AXIA'[DSC_PRODUTO],
//     "DIO_Dias", [DIO (Dias)],
//     "Cobertura_Dias", [Cobertura (Dias)],
//     "Giro_Estoque", [Giro de Estoque]
// )
// ORDER BY 'Dim Produto AXIA'[DSC_PRODUTO]

// ============================================================================
// NOTAS DE VALIDAÇÃO
// ============================================================================
// - Descomente cada grupo de medidas individualmente para executar
// - Salve os resultados em validation/results/ com nomenclatura:
//   * V2_grupo1_YYYYMMDD.csv
//   * V3_grupo1_YYYYMMDD.csv
//   * Golden_grupo1_YYYYMMDD.csv
// - Use ferramentas de diff para comparar os CSVs
// - Documente discrepâncias em validation/results/discrepancies.md
