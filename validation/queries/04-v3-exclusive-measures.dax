// ============================================================================
// QUERY DE VALIDAÇÃO - MEDIDAS EXCLUSIVAS V3
// ============================================================================
// Objetivo: Validar medidas que foram migradas do V3 para o Golden Dataset
// Data: 2026-02-03
// Fase: 3 - Validação de Medidas
// ============================================================================

// IMPORTANTE: Execute estas queries APENAS no V3 e no Golden Dataset
// Não execute no V2 (medidas não existem neste modelo)

// ============================================================================
// GRUPO 1: Medidas de Estoque Retroativo
// ============================================================================

EVALUATE
SUMMARIZECOLUMNS(
    'Dim Calendário'[Ano],
    'Dim Calendário'[Mês],
    'Dim Produto AXIA'[DSC_PRODUTO],
    "Estoque_Retroativo_R$", [Estoque Retroativo (R$)],
    "Estoque_Retroativo_un", [Estoque Retroativo (un)],
    "Custo_Medio_Retroativo", [Custo médio Retroativo]
)
ORDER BY 'Dim Calendário'[Ano], 'Dim Calendário'[Mês], 'Dim Produto AXIA'[DSC_PRODUTO]

// Validação: Comparar V3 vs Golden Dataset
// Tolerância: 0% (deve ser idêntico)

// ============================================================================
// GRUPO 2: Medidas Switch de Unidades
// ============================================================================

// EVALUATE
// SUMMARIZECOLUMNS(
//     'Dim Produto AXIA'[DSC_PRODUTO],
//     'Dim Filiais AXIA'[DSC_FILIAL],
//     "Vendas_un", [Vendas (un)],
//     "Vendas_KgL", [Vendas (Kg/L)],
//     "Vendas_Hec", [Vendas (Hec)],
//     "Vendas_R$", [Vendas (R$)]
// )
// ORDER BY 'Dim Produto AXIA'[DSC_PRODUTO]

// Validação: Verificar se conversões de unidade estão corretas
// Nota: Estas medidas dependem de seleção de parâmetro

// ============================================================================
// GRUPO 3: Medidas de Previsão S&OP
// ============================================================================

// EVALUATE
// SUMMARIZECOLUMNS(
//     'Dim Produto AXIA'[DSC_PRODUTO],
//     "Demanda_60_dias", [Demanda 60 dias],
//     "WMAPE", [WMAPE],
//     "Erro_Previsao", [Erro]
// )
// ORDER BY 'Dim Produto AXIA'[DSC_PRODUTO]

// Validação: Comparar V3 vs Golden Dataset
// Tolerância: < 0.1% (diferenças de arredondamento aceitáveis)

// ============================================================================
// GRUPO 4: Medidas POG (Plano Operacional de Gestão)
// ============================================================================

// EVALUATE
// SUMMARIZECOLUMNS(
//     'Dim Produto AXIA'[DSC_PRODUTO],
//     'Dim Filiais AXIA'[DSC_FILIAL],
//     "Estoq_Fat_Ante_Xd", [Estoq. - Fat. Ante. - Xd]
// )
// ORDER BY 'Dim Produto AXIA'[DSC_PRODUTO]

// Validação: Comparar V3 vs Golden Dataset
// Tolerância: 0% (deve ser idêntico)

// ============================================================================
// TESTE DE EXISTÊNCIA - Verificar se medidas foram migradas
// ============================================================================

// EVALUATE
// {
//     ("Estoque Retroativo (R$)", NOT(ISBLANK([Estoque Retroativo (R$)]))),
//     ("Estoque Retroativo (un)", NOT(ISBLANK([Estoque Retroativo (un)]))),
//     ("Custo médio Retroativo", NOT(ISBLANK([Custo médio Retroativo]))),
//     ("Vendas (un)", NOT(ISBLANK([Vendas (un)]))),
//     ("Vendas (Kg/L)", NOT(ISBLANK([Vendas (Kg/L)]))),
//     ("Vendas (Hec)", NOT(ISBLANK([Vendas (Hec)]))),
//     ("Vendas (R$)", NOT(ISBLANK([Vendas (R$)]))),
//     ("Demanda 60 dias", NOT(ISBLANK([Demanda 60 dias]))),
//     ("WMAPE", NOT(ISBLANK([WMAPE]))),
//     ("Erro", NOT(ISBLANK([Erro]))),
//     ("Estoq. - Fat. Ante. - Xd", NOT(ISBLANK([Estoq. - Fat. Ante. - Xd])))
// }

// Resultado esperado no Golden Dataset: Todas as medidas devem retornar TRUE

// ============================================================================
// NOTAS DE VALIDAÇÃO
// ============================================================================
// - Execute primeiro no V3 para obter valores de referência
// - Execute no Golden Dataset e compare resultados
// - Diferenças > 0.1% requerem investigação
// - Documente em validation/results/v3-exclusive-measures.md
// - Se alguma medida não existir no Golden, verificar migração
