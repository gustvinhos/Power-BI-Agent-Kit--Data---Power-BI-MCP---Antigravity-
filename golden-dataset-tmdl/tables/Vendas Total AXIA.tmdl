table 'Vendas Total AXIA'
	lineageTag: d3ebf746-1904-40bc-b7b5-706605abfecc

	measure Teste_Vendas_CFOP_CUSTO_MEDIO =
			
			SUM('Vendas Total AXIA'[VLR_CUSTO_TOTAL_MEDIO])
		lineageTag: cfd8a74c-ec0c-481a-94c9-26dc7acce68f

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column CNPJ
		dataType: string
		lineageTag: e8c4acf1-b24a-4a64-995d-d08b2ce5698c
		summarizeBy: none
		sourceColumn: CNPJ

		annotation SummarizationSetBy = Automatic

	column COD_FILIAL_AGENCIAMENTO
		dataType: string
		lineageTag: 5a7c0fba-9e93-40af-96d8-16fc5c0867c8
		summarizeBy: none
		sourceColumn: COD_FILIAL_AGENCIAMENTO

		annotation SummarizationSetBy = Automatic

	column NOM_VENDEDOR
		dataType: string
		lineageTag: 198fa0fb-2e9d-4b0b-8076-5ce89770ad75
		summarizeBy: none
		sourceColumn: NOM_VENDEDOR

		annotation SummarizationSetBy = Automatic

	column NOM_CLIENTE
		dataType: string
		lineageTag: 7af91d63-59b5-438d-9957-312962393841
		summarizeBy: none
		sourceColumn: NOM_CLIENTE

		annotation SummarizationSetBy = Automatic

	column COD_SISCOM
		dataType: string
		lineageTag: 6a3e31ee-927e-4f4f-96e0-93cf3c96a227
		summarizeBy: none
		sourceColumn: COD_SISCOM

		annotation SummarizationSetBy = Automatic

	column COD_PROTHEUS
		dataType: string
		lineageTag: 8595a8cb-3291-44b2-ac69-1142274d7e41
		summarizeBy: none
		sourceColumn: COD_PROTHEUS

		annotation SummarizationSetBy = Automatic

	column DSC_PRODUTO
		dataType: string
		lineageTag: 86c1ad7a-703c-4f66-b4be-c1e4fee33af9
		summarizeBy: none
		sourceColumn: DSC_PRODUTO

		annotation SummarizationSetBy = Automatic

	column DSC_FIN
		dataType: string
		lineageTag: 080ba9f8-2b9e-4a1f-abc2-9cd82b30f8ca
		summarizeBy: none
		sourceColumn: DSC_FIN

		annotation SummarizationSetBy = Automatic

	column FATOR_CONVERSAO
		dataType: double
		lineageTag: 97d84124-6f07-4de6-a3ae-ab25c4d1885d
		summarizeBy: sum
		sourceColumn: FATOR_CONVERSAO

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column DATA_VALIDADE
		dataType: dateTime
		formatString: Short Date
		lineageTag: 8e505200-2abf-4f8c-b41a-f123fb75f55a
		summarizeBy: none
		sourceColumn: DATA_VALIDADE

		annotation SummarizationSetBy = Automatic

	column QTD_DISP
		dataType: double
		lineageTag: 34e8a661-abed-44e5-bd53-4578e8bc34b5
		summarizeBy: sum
		sourceColumn: QTD_DISP

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column VLR_BRUTO_ITEM
		dataType: double
		lineageTag: 28db692c-d83e-4c26-bbd5-cd6e8a7ebc83
		summarizeBy: sum
		sourceColumn: VLR_BRUTO_ITEM

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column VLR_LIQ_ITEM
		dataType: double
		lineageTag: 6b76b748-aeeb-4caa-b2cf-6c8c44dd998b
		summarizeBy: sum
		sourceColumn: VLR_LIQ_ITEM

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column VLR_DESCONTO
		dataType: double
		lineageTag: c8a2c502-ba05-4b71-8c24-f49364e0dcc4
		summarizeBy: sum
		sourceColumn: VLR_DESCONTO

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column VLR_CUSTO_UNIT_AQUISICAO
		dataType: double
		formatString: "R$"\ #,0.00;-"R$"\ #,0.00;"R$"\ #,0.00
		lineageTag: 9dd2800d-da8b-49e9-8425-2ccc3010dff5
		summarizeBy: sum
		sourceColumn: VLR_CUSTO_UNIT_AQUISICAO

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"currencyCulture":"pt-BR"}

	column NUM_NF
		dataType: string
		lineageTag: dc34c343-6d4f-4cc5-a797-5f44065cbfe9
		summarizeBy: none
		sourceColumn: NUM_NF

		annotation SummarizationSetBy = Automatic

	column NUM_SERIE
		dataType: string
		lineageTag: 74632394-5054-45f5-a347-afe8893d0a65
		summarizeBy: none
		sourceColumn: NUM_SERIE

		annotation SummarizationSetBy = Automatic

	column DATA_EMISSAO
		dataType: dateTime
		formatString: Short Date
		lineageTag: 27b90716-f19f-4fa3-a16b-c2f3552f73a3
		summarizeBy: none
		sourceColumn: DATA_EMISSAO

		changedProperty = DataType

		annotation SummarizationSetBy = Automatic

		annotation UnderlyingDateTimeDataType = Date

	column DATA_DEVOLUCAO
		dataType: dateTime
		formatString: Short Date
		lineageTag: f69dfac5-f29e-46af-830c-a8140d239422
		summarizeBy: none
		sourceColumn: DATA_DEVOLUCAO

		annotation SummarizationSetBy = Automatic

	column NOM_FORNECEDOR
		dataType: string
		lineageTag: a2873e51-22a7-43c6-bd29-7f6ee97b99fb
		summarizeBy: none
		sourceColumn: NOM_FORNECEDOR

		annotation SummarizationSetBy = Automatic

	column COND_PAGTO
		dataType: string
		lineageTag: 862077a2-2862-455c-ae55-251ac821b854
		summarizeBy: none
		sourceColumn: COND_PAGTO

		annotation SummarizationSetBy = Automatic

	column SITUACAO
		dataType: string
		lineageTag: 44d1f7b6-e8f2-4400-894c-a3c1d7ac13fb
		summarizeBy: none
		sourceColumn: SITUACAO

		annotation SummarizationSetBy = Automatic

	column TIPO_VENDA
		dataType: string
		lineageTag: 120e4d41-d51a-4008-b66a-3728be91d879
		summarizeBy: none
		sourceColumn: TIPO_VENDA

		annotation SummarizationSetBy = Automatic

	column DSC_OPERACAO
		dataType: string
		lineageTag: 6b81e0ea-0658-4507-8235-9c138828b47a
		summarizeBy: none
		sourceColumn: DSC_OPERACAO

		annotation SummarizationSetBy = Automatic

	column ORIGEM
		dataType: string
		lineageTag: e7971ad3-d1ac-4926-af81-b0e707f53147
		summarizeBy: none
		sourceColumn: ORIGEM

		annotation SummarizationSetBy = Automatic

	column FLG_IS_DEV
		dataType: string
		lineageTag: f65911cb-1495-4cad-899b-fa5907efafab
		summarizeBy: none
		sourceColumn: FLG_IS_DEV

		annotation SummarizationSetBy = Automatic

	column CIDADE_CLIENTE
		dataType: string
		lineageTag: f4229d76-04cc-4924-a2b0-5a2159136762
		summarizeBy: none
		sourceColumn: CIDADE_CLIENTE

		annotation SummarizationSetBy = Automatic

	column CNPJ_CLIENTE
		dataType: string
		lineageTag: d494e231-5d74-4454-93bd-bf63501f4c08
		summarizeBy: none
		sourceColumn: CNPJ_CLIENTE

		annotation SummarizationSetBy = Automatic

	column CFOP
		dataType: string
		lineageTag: 01ef540f-8978-4b8e-9055-bc7d5085f76f
		summarizeBy: none
		sourceColumn: CFOP

		annotation SummarizationSetBy = Automatic

	column ID_PRODUTO
		dataType: int64
		formatString: 0
		lineageTag: 365b76d7-101e-4e94-bbf9-0558c80b864b
		summarizeBy: none
		sourceColumn: ID_PRODUTO

		annotation SummarizationSetBy = Automatic

	column FLG_INTERCOMPANY
		dataType: int64
		formatString: 0
		lineageTag: 74ced7f8-c033-4248-8850-4bde289313ea
		summarizeBy: sum
		sourceColumn: FLG_INTERCOMPANY

		annotation SummarizationSetBy = Automatic

	column 'É Real Saída' = ```
			
			VAR TipoVendaOk = 'Vendas Total AXIA'[TIPO_VENDA] IN {"2", "4"}
			VAR SituacaoOk = 'Vendas Total AXIA'[SITUACAO] = "OK"
			VAR NaoIntercompany = 'Vendas Total AXIA'[FLG_INTERCOMPANY] = 0
			--VAR ClassGerencial = 
			--    LOOKUPVALUE(
			--        'Dim CFOP'[CLASSIFICACAO_GERENCIAL],
			--        'Dim CFOP'[CFOP], 'Vendas Total AXIA'[CFOP]
			--    )
			--VAR ClassificacoesValidas = 
			--    ClassGerencial IN {
			--        "S7 - Serviço",
			--        "S4 - Simples remessa",
			--        "E8 - Devolução",
			--        "S2 - Real Saídas"
			--    }
			
			RETURN 
			IF(
			    TipoVendaOk && SituacaoOk && NaoIntercompany,-- && ClassificacoesValidas,
			    "Sim",
			    "Não"
			)
			```
		lineageTag: fdcba105-e618-4b62-8331-aacb97192044
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	column CLASSIFICACAO_GERENCIAL =
			
			
			RELATED('Dim CFOP'[CLASSIFICACAO_GERENCIAL])
		lineageTag: 99c40eb8-8eb6-48ab-8497-2185f0688a87
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	column FLG_REAL_SAIDA = ```
			
			VAR ORIGEM = UPPER( TRIM( 'Vendas Total AXIA'[ORIGEM] ) )
			VAR DATAFILTRO = DATE(2023, 1, 1)
			RETURN
			SWITCH(
			    TRUE(),
			    ORIGEM IN { "SISCOM", "PROTHEUS" }
			        && 'Vendas Total AXIA'[FLG_INTERCOMPANY] = 0
			        && 'Vendas Total AXIA'[TIPO_VENDA] IN { "2", "3", "4" }
			        && 'Vendas Total AXIA'[DATA_EMISSAO] >= DATAFILTRO
			        && 'Vendas Total AXIA'[NOM_VENDEDOR] <> "VENDAS LAVORO",
			        "REAL SAÍDA",
			    ORIGEM = "BLUE"
			        && 'Vendas Total AXIA'[FLG_INTERCOMPANY] = 0
			        && 'Vendas Total AXIA'[CLASSIFICACAO_GERENCIAL] IN {
			             "S7 - Serviço",
			             "S4 - Simples remessa",
			             "E8 - Devolução",
			             "S2 - Real Saídas"
			          }
			        && 'Vendas Total AXIA'[DATA_EMISSAO] >= DATAFILTRO
			        && 'Vendas Total AXIA'[NOM_VENDEDOR] <> "VENDAS LAVORO",
			        "REAL SAÍDA",
			    "OUTRAS SAÍDAS"
			)
			
			```
		lineageTag: ba458e47-af88-4694-80de-42153671c491
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	column 'Data da Última Entrada' =
			
			
			CALCULATE(
			    MAX('Entradas Axia'[DATA_ENTRADA]),
			    FILTER(
			        'Entradas Axia',
			        'Entradas Axia'[ID_PRODUTO] = 'Vendas Total AXIA'[ID_PRODUTO] &&
			        'Entradas Axia'[COD_FILIAL] = 'Vendas Total AXIA'[CNPJ]
			    )
			)
		formatString: Short Date
		lineageTag: 8721d385-2b24-46a4-9751-4499b50be8be
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	column 'Data da Última Venda' =
			
			
			CALCULATE(
			    MAX('Vendas Total AXIA'[DATA_EMISSAO]),
			    FILTER(
			        'Vendas Total AXIA',
			        'Vendas Total AXIA'[ID_PRODUTO] = EARLIER('Vendas Total AXIA'[ID_PRODUTO]) &&
			        'Vendas Total AXIA'[CNPJ] = EARLIER('Vendas Total AXIA'[CNPJ])
			    )
			)
		formatString: Short Date
		lineageTag: b89c19f0-48a0-4a54-bba2-95ceb35762f8
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	column COD_BLUE
		dataType: string
		lineageTag: 297d4e9d-ccc1-441d-bbfd-3e97648ef794
		summarizeBy: none
		sourceColumn: COD_BLUE

		annotation SummarizationSetBy = Automatic

	column VLR_ICMS
		dataType: double
		formatString: "R$"\ #,0.00;-"R$"\ #,0.00;"R$"\ #,0.00
		lineageTag: 54981cf8-37b4-4d79-9732-8090764ddc56
		summarizeBy: sum
		sourceColumn: VLR_ICMS

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"currencyCulture":"pt-BR"}

	column VLR_PIS
		dataType: double
		formatString: "R$"\ #,0.00;-"R$"\ #,0.00;"R$"\ #,0.00
		lineageTag: a82e2297-7f10-4b5e-a7a8-ad380546f32a
		summarizeBy: sum
		sourceColumn: VLR_PIS

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"currencyCulture":"pt-BR"}

	column VLR_COFINS
		dataType: double
		formatString: "R$"\ #,0.00;-"R$"\ #,0.00;"R$"\ #,0.00
		lineageTag: f422bb52-b061-463b-bc24-6b363c0639a4
		summarizeBy: sum
		sourceColumn: VLR_COFINS

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"currencyCulture":"pt-BR"}

	column DSC_UNIFICADA
		dataType: string
		lineageTag: 6807fd22-5e11-455d-ac8a-5805096f1d27
		summarizeBy: none
		sourceColumn: DSC_UNIFICADA

		annotation SummarizationSetBy = Automatic

	column KGLT_DISP = ```
			
			IF (
			    RELATED ( 'Dim Produto AXIA'[Dsc_Grupo] ) IN {
			        "adjuvante",
			        "adubos, fertilizantes & corretivos",
			        "defensivos",
			        "hortifruti",
			        "nutrição",
			        "sementes"
			    },
			    RELATED ( 'Dim Produto AXIA'[Peso] ) * 'Vendas Total AXIA'[QTD_AJUSTADA_OUTLIER],
			    'Vendas Total AXIA'[FATOR_CONVERSAO] * 'Vendas Total AXIA'[QTD_AJUSTADA_OUTLIER]
			)
			 
			```
		lineageTag: 0d314fc2-0093-4e68-b009-d4fc916d6d45
		summarizeBy: sum

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column VLR_CUSTO_CMV
		dataType: double
		lineageTag: 08177c7f-5ee7-4e37-9af1-6f4b31bdf20c
		summarizeBy: sum
		sourceColumn: VLR_CUSTO_CMV

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column QTD_AJUSTADA_OUTLIER
		dataType: double
		lineageTag: e213ecab-2f94-44b8-acb7-458998fe261f
		summarizeBy: sum
		sourceColumn: QTD_AJUSTADA_OUTLIER

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column NUM_ITEM_NF
		dataType: string
		lineageTag: 6be5013d-c6ce-40ea-b911-791480a5aa6b
		summarizeBy: none
		sourceColumn: NUM_ITEM_NF

		annotation SummarizationSetBy = Automatic

	column VLR_UNIT
		dataType: double
		lineageTag: 86b2b832-93c7-4e50-a6a5-a62e8687f8d7
		summarizeBy: sum
		sourceColumn: VLR_UNIT

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column VLR_CUSTO_UNIT_MEDIO
		dataType: double
		lineageTag: 74ba85d5-9d62-4d77-990a-56392b206f7b
		summarizeBy: sum
		sourceColumn: VLR_CUSTO_UNIT_MEDIO

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column VLR_CUSTO_TOTAL_MEDIO
		dataType: double
		lineageTag: ed46e74b-010f-42c0-838d-b46a755108a2
		summarizeBy: sum
		sourceColumn: VLR_CUSTO_TOTAL_MEDIO

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column VLR_CUSTO_UNIT_BRUTO
		dataType: double
		lineageTag: 7f9a4861-99de-4d4f-aa4e-71e4447a9a9b
		summarizeBy: sum
		sourceColumn: VLR_CUSTO_UNIT_BRUTO

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column VLR_CUSTO_TOTAL_BRUTO
		dataType: double
		lineageTag: 9152019c-01db-4d20-a00e-7288cf52794b
		summarizeBy: sum
		sourceColumn: VLR_CUSTO_TOTAL_BRUTO

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column DESC_CFOP
		dataType: string
		lineageTag: 9d803942-fdf4-42c1-9190-142b5af3df02
		summarizeBy: none
		sourceColumn: DESC_CFOP

		annotation SummarizationSetBy = Automatic

	column CHAVE_NFE
		dataType: string
		lineageTag: 03d0c0f0-1113-4da6-958a-ec3272d1df59
		summarizeBy: none
		sourceColumn: CHAVE_NFE

		annotation SummarizationSetBy = Automatic

	column Peso = related('Dim Produto AXIA'[Peso])
		lineageTag: 13678747-55c3-41ba-a51c-9d6199eaf78b
		summarizeBy: sum

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	partition 'Vendas Total AXIA' = m
		mode: import
		source =
				let
				    Fonte = Sql.Database("agroops.database.windows.net", "axiapool", [Query="SELECT * FROM  [8_AUX].[VW_MOVIMENTACOES_REAL_SAIDA_AXIA_AJUSTADA] where data_emissao >= '01-01-2023'"])
				in
				    Fonte

	annotation PBI_ResultType = Table

	annotation PBI_NavigationStepName = Navegação

